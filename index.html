<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>پیش‌گویی تاریخ مرگ</title>
    
    <style>
        @font-face {
            font-family: 'Vazir';
            src: url('https://cdn.jsdelivr.net/gh/rastikerdar/vazirmatn@v33.0.0/fonts/webfonts/Vazirmatn-Regular.woff2') format('woff2');
            font-weight: normal;
            font-style: normal;
        }

        body {
            font-family: 'Vazir', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: #333;
            line-height: 1.6;
            margin: 0;
            padding: 0;
            direction: rtl;
            text-align: right;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .hidden {
            display: none !important;
        }

        .container {
            width: 100%;
            max-width: 90%;
            margin: 0 auto;
            padding: 20px 0;
        }

        .card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
            margin: 20px 0;
        }

        h1, h2, h3 {
            color: #333;
            text-align: center;
            font-weight: bold;
        }

        h1 {
            font-size: 2rem;
            color: #007bff;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            font-weight: bold;
            display: block;
            margin-bottom: 8px;
            color: #555;
            font-size: 0.9rem;
        }

        input[type="text"], input[type="number"] {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 8px;
            box-sizing: border-box;
            font-size: 0.9rem;
            transition: border-color 0.3s ease;
        }
        
        input[type="text"]:focus, input[type="number"]:focus {
            border-color: #007bff;
            outline: none;
        }

        button {
            background-color: #007bff;
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-family: 'Vazir', sans-serif;
            font-size: 1rem;
            width: 100%;
            transition: background-color 0.3s ease, transform 0.2s ease;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }

        button:hover {
            background-color: #0056b3;
            transform: translateY(-2px);
        }

        .question {
            margin-bottom: 25px;
            padding: 15px;
            border-radius: 10px;
            background-color: #f8f9fa;
        }

        .question p {
            font-weight: bold;
            margin-bottom: 12px;
            color: #444;
            font-size: 0.95rem;
        }

        .options-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 8px;
        }

        .option input[type="radio"] {
            display: none;
        }

        .option label {
            display: block;
            background-color: #e9ecef;
            padding: 12px;
            border-radius: 8px;
            border: 2px solid #e9ecef;
            cursor: pointer;
            transition: background-color 0.3s ease, border-color 0.3s ease;
            text-align: center;
            font-size: 0.85rem;
        }

        .option input[type="radio"]:checked + label {
            background-color: #e2f4ff;
            border-color: #007bff;
            font-weight: bold;
        }

        #tombstone {
            background: #495057; /* Darker, more readable color */
            color: #f8f9fa;
            padding: 40px 20px;
            margin: 30px auto;
            text-align: center;
            position: relative;
            max-width: 400px;
            min-height: 500px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border: 5px solid #343a40;
            border-radius: 20px 20px 10px 10px;
            box-shadow: 0 15px 40px rgba(0,0,0,0.4);
        }

        #tombstone .top-text {
            font-size: 0.9rem;
            margin-bottom: 8px;
            color: #dee2e6;
        }

        #tombstone .top-poem {
            font-size: 1.1rem;
            font-style: italic;
            margin-bottom: 15px;
            color: #dee2e6;
        }

        .tombstone-content {
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 10px;
            width: 90%;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        #tombstone-name {
            font-size: 1.8rem;
            margin-bottom: 8px;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.3);
        }

        #tombstone-dates {
            font-size: 1rem;
            margin-top: 0;
            color: #ccc;
        }

        #tombstone hr {
            width: 70%;
            border-color: rgba(255, 255, 255, 0.5);
            margin: 15px auto;
        }

        #tombstone-bio, #tombstone-cause, #tombstone-poem {
            font-size: 0.9rem;
            margin: 12px 0;
            line-height: 1.8;
            color: #f1f3f5;
        }

        .final-message {
            text-align: center;
            margin-top: 25px;
            background-color: #fff;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .final-message h2 {
            color: #e74c3c;
            font-size: 1.5rem;
        }
        
        .final-message p {
            font-size: 0.9rem;
            color: #555;
            margin-bottom: 15px;
        }

        #suggestions-list {
            list-style-type: none;
            padding: 0;
            text-align: right;
        }

        #suggestions-list li {
            background: #fff3f3;
            padding: 12px;
            margin-bottom: 8px;
            border-radius: 8px;
            border-right: 5px solid #e74c3c;
            color: #555;
            font-size: 0.9rem;
        }

        footer {
            margin-top: 20px;
            font-size: 0.7rem;
            color: #777;
            text-align: center;
            padding: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>پیش‌گویی تاریخ مرگ</h1>
            <p style="text-align: center; color: #555;">با پاسخ به چند سوال ساده، از آینده خود باخبر شوید!</p>
        </header>

        <main>
            <section id="user-info-section" class="card">
                <h2>اطلاعات فردی</h2>
                <form id="user-info-form">
                    <div class="form-group">
                        <label for="name">نام و نام خانوادگی:</label>
                        <input type="text" id="name" required>
                    </div>
                    <div class="form-group">
                        <label for="age">سن:</label>
                        <input type="number" id="age" min="1" max="120" required>
                    </div>
                    <button type="submit" id="start-btn">شروع پیش‌گویی</button>
                </form>
            </section>

            <section id="questions-section" class="card hidden">
                <h2>۳۰ سؤال بی‌رحم برای پیش‌بینی تاریخ و علت مرگ شما</h2>
                <p style="text-align: center; color: #555;">(هر سؤال دارای ۶ گزینه: از نرمال تا خطرناک یا فروپاشیده)</p>
                <form id="questions-form">
                    </form>
                <button id="calculate-btn">محاسبه تاریخ مرگ</button>
            </section>

            <section id="results-section" class="card hidden">
                <div id="tombstone">
                    <p class="top-text">إنا لله وإنا إليه راجعون</p>
                    <p class="top-poem">گلچین روزگار عجب خوش سلیقه است</p>
                    <div class="tombstone-content">
                        <h3 id="tombstone-name"></h3>
                        <p id="tombstone-dates"></p>
                        <hr>
                        <p id="tombstone-bio"></p>
                        <p id="tombstone-cause"></p>
                        <p id="tombstone-poem"></p>
                    </div>
                </div>
                <div class="final-message">
                    <p id="final-congrats"></p>
                    <h2>کارهایی که باید انجام دهی</h2>
                    <ul id="suggestions-list">
                        </ul>
                </div>
                <button id="restart-btn">شروع مجدد</button>
            </section>
        </main>
        <footer>
            <p>این تاریخ با مشارکت دانشگاه پیتر و جورج انگلستان، صنایع نیمه‌هادی تایوان، دانشگاه کیم جونگ اون کره شمالی و وزارت دفاع آمریکا طراحی و تایید شده است. تاریخ‌ها کاملاً دقیق و معتبر هستند.</p>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const userInfoSection = document.getElementById('user-info-section');
            const questionsSection = document.getElementById('questions-section');
            const resultsSection = document.getElementById('results-section');
            const userInfoForm = document.getElementById('user-info-form');
            const questionsForm = document.getElementById('questions-form');
            const nameInput = document.getElementById('name');
            const ageInput = document.getElementById('age');
            const calculateBtn = document.getElementById('calculate-btn');
            const restartBtn = document.getElementById('restart-btn');
            const tombstoneName = document.getElementById('tombstone-name');
            const tombstoneDates = document.getElementById('tombstone-dates');
            const tombstoneBio = document.getElementById('tombstone-bio');
            const tombstoneCause = document.getElementById('tombstone-cause');
            const tombstonePoem = document.getElementById('tombstone-poem');
            const suggestionsList = document.getElementById('suggestions-list');
            const finalCongrats = document.getElementById('final-congrats');

            let userName = '';
            let userAge = 0;
            const questions = [
                {
                    text: "1. وضعیت خواب شبت چطوره؟",
                    options: [
                        { text: "A) ۷–۸ ساعت منظم", score: 5, cause: ["کهولت سن و عوامل طبیعی"] },
                        { text: "B) بی‌نظم ولی کافی", score: 2, cause: ["سکته"] },
                        { text: "C) تا ۳ شب بیدارم", score: -2, cause: ["سکته", "فرسایش عصبی"] },
                        { text: "D) کابوس و بیداری وسط شب", score: -5, cause: ["سکته", "فرسایش عصبی", "افسردگی"] },
                        { text: "E) با قرص و دود می‌خوابم", score: -10, cause: ["اوردوز", "فرسایش عصبی", "افسردگی"] },
                        { text: "F) خواب ندارم. فقط زنده‌م", score: -15, cause: ["سکته", "فرسایش عصبی", "افسردگی"] }
                    ]
                },
                {
                    text: "2. چقدر فعالیت بدنی داری؟",
                    options: [
                        { text: "A) هر روز ورزش", score: 5, cause: ["کهولت سن و عوامل طبیعی"] },
                        { text: "B) پیاده‌روی سبک", score: 3, cause: ["کهولت سن و عوامل طبیعی"] },
                        { text: "C) فقط سر کار حرکت دارم", score: 0, cause: ["سکته قلبی", "چاقی مرگبار"] },
                        { text: "D) تقریباً ثابت", score: -3, cause: ["سکته قلبی", "چاقی مرگبار"] },
                        { text: "E) از تخت به مبل", score: -7, cause: ["سکته قلبی", "چاقی مرگبار"] },
                        { text: "F) تحرک؟ نهایتاً تکون مچ", score: -10, cause: ["سکته قلبی", "چاقی مرگبار", "ضعف شدید عضلانی"] }
                    ]
                },
                {
                    text: "3. باهات چندبار در سال دعوا فیزیکی یا کلامی شدید شده؟",
                    options: [
                        { text: "A) صفر", score: 5, cause: ["کهولت سن و عوامل طبیعی"] },
                        { text: "B) یکی دوبار", score: 0, cause: ["سکته عصبی"] },
                        { text: "C) چند ماه یه‌بار", score: -5, cause: ["قتل", "سکته عصبی", "خودزنی"] },
                        { text: "D) ماهی یه بار", score: -10, cause: ["قتل", "سکته عصبی", "خودزنی"] },
                        { text: "E) هفتگی", score: -15, cause: ["قتل", "سکته عصبی", "خودزنی"] },
                        { text: "F) هرروز، حتی با آینه", score: -20, cause: ["قتل", "سکته عصبی", "خودزنی"] }
                    ]
                },
                {
                    text: "4. مصرف الکل و مواد چطوره؟",
                    options: [
                        { text: "A) هیچ", score: 10, cause: ["کهولت سن و عوامل طبیعی"] },
                        { text: "B) تفریحی", score: 5, cause: ["تصادف", "حادثه در حین مصرف"] },
                        { text: "C) گهگاهی سنگین", score: -5, cause: ["اور دوز", "مشکلات کبدی"] },
                        { text: "D) منظم ولی نه روزانه", score: -15, cause: ["اور دوز", "مشکلات کبدی", "حادثه در حین مصرف"] },
                        { text: "E) روزانه", score: -20, cause: ["اور دوز", "مشکلات کبدی", "مسمومیت"] },
                        { text: "F) هرچی دم دستم باشه می‌زنم", score: -25, cause: ["اور دوز", "نارسایی کبد"] }
                    ]
                },
                {
                    text: "5. درگیری جنسی خارج‌روابط یا خطرناک داشتی؟",
                    options: [
                        { text: "A) هرگز", score: 5, cause: ["کهولت سن و عوامل طبیعی"] },
                        { text: "B) یکی دو بار", score: 0, cause: ["بیماری‌های مقاربتی"] },
                        { text: "C) گهگاه", score: -5, cause: ["ایدز", "بیماری‌های مقاربتی", "قتل از طرف شریک جنسی"] },
                        { text: "D) زیاد", score: -10, cause: ["ایدز", "بیماری‌های مقاربتی", "قتل از طرف شریک جنسی"] },
                        { text: "E) با هرکسی که موقعیت باشه", score: -15, cause: ["ایدز", "بیماری‌های مقاربتی", "قتل از طرف شریک جنسی"] },
                        { text: "F) نه می‌پرسم نه می‌دونم، فقط انجام می‌دم", score: -20, cause: ["ایدز", "بیماری‌های مقاربتی", "قتل از طرف شریک جنسی"] }
                    ]
                },
                {
                    text: "6. چند بار به خودکشی یا مردن فکر کردی؟",
                    options: [
                        { text: "A) هیچ‌وقت", score: 5, cause: ["کهولت سن و عوامل طبیعی"] },
                        { text: "B) گاهی", score: -3, cause: ["افسردگی"] },
                        { text: "C) وقت ناراحتی شدید", score: -7, cause: ["افسردگی", "خودکشی"] },
                        { text: "D) ماهی یکی‌دو بار", score: -12, cause: ["افسردگی", "خودکشی", "سقوط ناگهانی"] },
                        { text: "E) هر هفته", score: -18, cause: ["افسردگی", "خودکشی", "فروپاشی روانی"] },
                        { text: "F) هر روز", score: -25, cause: ["افسردگی", "خودکشی", "فروپاشی روانی"] }
                    ]
                },
                {
                    text: "7. آخرین بار که با عشق واقعی رابطه داشتی؟",
                    options: [
                        { text: "A) الان دارم", score: 5, cause: ["کهولت سن و عوامل طبیعی"] },
                        { text: "B) سال گذشته", score: 2, cause: ["افسردگی"] },
                        { text: "C) چند سال پیش", score: -5, cause: ["فروپاشی روانی", "افسردگی"] },
                        { text: "D) دیگه عشق رو باور ندارم", score: -10, cause: ["فروپاشی روانی", "افسردگی", "خودکشی"] },
                        { text: "E) فقط سکس بوده، عشق نبوده", score: -15, cause: ["فروپاشی روانی", "افسردگی", "خودکشی"] },
                        { text: "F) هیچ‌وقت. فقط من بودم و تنهایی", score: -20, cause: ["فروپاشی روانی", "افسردگی", "خودکشی"] }
                    ]
                },
                {
                    text: "8. رژیم غذایی‌ت چطوره؟",
                    options: [
                        { text: "A) کنترل‌شده", score: 5, cause: ["کهولت سن و عوامل طبیعی"] },
                        { text: "B) نه سالم ولی معمولی", score: 2, cause: ["چربی", "قلب"] },
                        { text: "C) پرچرب و قندی", score: -5, cause: ["دیابت", "چربی", "قلب"] },
                        { text: "D) غذاهای آماده و فست‌فود", score: -8, cause: ["دیابت", "چربی", "قلب", "چاقی"] },
                        { text: "E) وعده‌ی درست نمی‌خورم", score: -12, cause: ["دیابت", "چربی", "قلب", "سوءتغذیه"] },
                        { text: "F) شکمم پره، ولی از زهر", score: -15, cause: ["دیابت", "چربی", "قلب", "سوءتغذیه"] }
                    ]
                },
                {
                    text: "9. اضافه وزن داری؟",
                    options: [
                        { text: "A) نه", score: 5, cause: ["کهولت سن و عوامل طبیعی"] },
                        { text: "B) کمی", score: 0, cause: ["فشار"] },
                        { text: "C) متوسط", score: -5, cause: ["چاقی", "قلب", "فشار"] },
                        { text: "D) چاقی شدید", score: -10, cause: ["چاقی مرگبار", "قلب", "فشار"] },
                        { text: "E) من با نون زنده‌م", score: -15, cause: ["چاقی مرگبار", "قلب", "فشار"] },
                        { text: "F) آره ولی دیگه مهم نیست", score: -20, cause: ["چاقی مرگبار", "قلب", "فشار"] }
                    ]
                },
                {
                    text: "10. فشار خون‌ت چطوره؟",
                    options: [
                        { text: "A) نرمال", score: 5, cause: ["کهولت سن و عوامل طبیعی"] },
                        { text: "B) کمی بالاست", score: 0, cause: ["سکته مغزی", "سکته قلبی"] },
                        { text: "C) بالاست و دارو دارم", score: -5, cause: ["سکته مغزی", "سکته قلبی"] },
                        { text: "D) اندازه نمی‌گیرم", score: -10, cause: ["سکته مغزی", "سکته قلبی"] },
                        { text: "E) بالا و بی‌خیالم", score: -15, cause: ["سکته مغزی", "سکته قلبی"] },
                        { text: "F) کِی بمیرم خلاص شم؟", score: -20, cause: ["سکته مغزی", "سکته قلبی", "خودکشی"] }
                    ]
                },
                {
                    text: "11. توی ماه چند بار کنترل خودتو از دست می‌دی؟",
                    options: [
                        { text: "A) هیچ‌وقت", score: 5, cause: ["کهولت سن و عوامل طبیعی"] },
                        { text: "B) گاهی", score: 0, cause: ["فشار روانی"] },
                        { text: "C) تو فشار شدید", score: -5, cause: ["قتل", "درگیری", "فشار روانی"] },
                        { text: "D) هفته‌ای یکی‌دو بار", score: -10, cause: ["قتل", "درگیری", "فشار روانی"] },
                        { text: "E) هر بار که کسی حرف بزنه", score: -15, cause: ["قتل", "درگیری", "فشار روانی"] },
                        { text: "F) کنترل؟ ندارم که از دستش بدم", score: -20, cause: ["قتل", "درگیری", "فشار روانی"] }
                    ]
                },
                {
                    text: "12. وقتی تنهایی، چه حسی داری؟",
                    options: [
                        { text: "A) آرامش", score: 5, cause: ["کهولت سن و عوامل طبیعی"] },
                        { text: "B) گاهی دلگیر", score: -2, cause: ["افسردگی مزمن"] },
                        { text: "C) افسرده", score: -7, cause: ["افسردگی مزمن", "خودکشی"] },
                        { text: "D) خفه", score: -12, cause: ["افسردگی مزمن", "خودکشی"] },
                        { text: "E) پوچ", score: -15, cause: ["افسردگی مزمن", "خودکشی"] },
                        { text: "F) حس می‌کنم وجود ندارم", score: -20, cause: ["افسردگی مزمن", "خودکشی", "سکته"] }
                    ]
                },
                {
                    text: "13. چند بار رانندگی خطرناک داشتی؟",
                    options: [
                        { text: "A) هیچ‌وقت", score: 5, cause: ["کهولت سن و عوامل طبیعی"] },
                        { text: "B) یکی‌دوبار", score: 0, cause: ["تصادف"] },
                        { text: "C) گهگاه", score: -5, cause: ["تصادف", "قتل غیرعمد"] },
                        { text: "D) سرعتم همیشه بالاست", score: -10, cause: ["تصادف", "قتل غیرعمد"] },
                        { text: "E) با دود و الکل پشت فرمونم", score: -15, cause: ["تصادف", "قتل غیرعمد"] },
                        { text: "F) حواسم نیست، فقط می‌رم", score: -20, cause: ["تصادف", "قتل غیرعمد"] }
                    ]
                },
                {
                    text: "14. فشار مالی چه بلایی سرت آورده؟",
                    options: [
                        { text: "A) قابل مدیریت", score: 5, cause: ["کهولت سن و عوامل طبیعی"] },
                        { text: "B) اذیتم می‌کنه", score: 0, cause: ["ایست قلبی"] },
                        { text: "C) مدام استرس دارم", score: -5, cause: ["خودکشی", "ایست قلبی"] },
                        { text: "D) بدهکار و شرمنده‌م", score: -10, cause: ["خودکشی", "ایست قلبی", "درگیری"] },
                        { text: "E) حس بی‌ارزشی دارم", score: -15, cause: ["خودکشی", "ایست قلبی"] },
                        { text: "F) باعث شد بخوام بمیرم", score: -20, cause: ["خودکشی", "ایست قلبی"] }
                    ]
                },
                {
                    text: "15. چند ساعت در روز پای گوشی‌ای؟",
                    options: [
                        { text: "A) ۱–۲ ساعت", score: 5, cause: ["کهولت سن و عوامل طبیعی"] },
                        { text: "B) ۳–۵ ساعت", score: 2, cause: ["تحلیل روانی"] },
                        { text: "C) ۶–۸ ساعت", score: -2, cause: ["تحلیل روانی", "انزوای اجتماعی"] },
                        { text: "D) ۱۰ ساعت به بالا", score: -7, cause: ["تحلیل روانی", "انزوای اجتماعی", "افسردگی"] },
                        { text: "E) خواب و بیدار با گوشی", score: -12, cause: ["تحلیل روانی", "انزوای اجتماعی", "خودکشی"] },
                        { text: "F) دنیای واقعی ازم متنفره", score: -15, cause: ["تحلیل روانی", "انزوای اجتماعی", "خودکشی"] }
                    ]
                },
                {
                    text: "16. چندبار بدن‌تو آزار دادی؟",
                    options: [
                        { text: "A) هیچ‌وقت", score: 5, cause: ["کهولت سن و عوامل طبیعی"] },
                        { text: "B) یه بار", score: -5, cause: ["خودزنی", "فروپاشی عصبی"] },
                        { text: "C) با فشار ناخن، کندن مو", score: -10, cause: ["خودزنی", "فروپاشی عصبی"] },
                        { text: "D) بریدن پوست", score: -15, cause: ["خودزنی", "فروپاشی عصبی"] },
                        { text: "E) سوزوندن", score: -20, cause: ["خودزنی", "فروپاشی عصبی"] },
                        { text: "F) بارها تا خون بیاد", score: -25, cause: ["خودزنی مزمن", "فروپاشی عصبی", "خودکشی"] }
                    ]
                },
                {
                    text: "17. آخرین بار که کسی رو بخشیدی؟",
                    options: [
                        { text: "A) همین دیروز", score: 5, cause: ["کهولت سن و عوامل طبیعی"] },
                        { text: "B) ماه پیش", score: 2, cause: ["فشار عصبی"] },
                        { text: "C) سال پیش", score: -3, cause: ["فشار عصبی", "انفجار عصبی"] },
                        { text: "D) نمی‌بخشم", score: -8, cause: ["قتل", "انفجار عصبی"] },
                        { text: "E) همه باید تاوان بدن", score: -15, cause: ["قتل", "انفجار عصبی", "مرگ از خشونت"] },
                        { text: "F) اگه دستم برسه، انتقام می‌گیرم", score: -20, cause: ["قتل", "انفجار عصبی", "مرگ از خشونت"] }
                    ]
                },
                {
                    text: "18. رابطه‌ت با پدر/مادرت؟",
                    options: [
                        { text: "A) نزدیک و گرم", score: 5, cause: ["کهولت سن و عوامل طبیعی"] },
                        { text: "B) محترمانه", score: 3, cause: ["کهولت سن و عوامل طبیعی"] },
                        { text: "C) سرد", score: -3, cause: ["اختلال روانی"] },
                        { text: "D) پر تنش", score: -7, cause: ["اختلال روانی", "افسردگی"] },
                        { text: "E) بدون ارتباط", score: -12, cause: ["اختلال روانی", "افسردگی", "خودکشی"] },
                        { text: "F) اونا دلیل همه زخمامن", score: -18, cause: ["اختلال روانی", "افسردگی", "خودکشی", "مصرف مواد"] }
                    ]
                },
                {
                    text: "19. مصرف داروهای اعصاب؟",
                    options: [
                        { text: "A) نمی‌خورم", score: 5, cause: ["کهولت سن و عوامل طبیعی"] },
                        { text: "B) کم و کنترل‌شده", score: 0, cause: ["فروپاشی روانی"] },
                        { text: "C) گاهی اجباری", score: -5, cause: ["مصرف ترکیبی", "فروپاشی روانی"] },
                        { text: "D) منظم و قوی", score: -10, cause: ["مصرف ترکیبی", "فروپاشی روانی"] },
                        { text: "E) خودسر و زیاد", score: -15, cause: ["مصرف ترکیبی", "فروپاشی روانی", "اور دوز"] },
                        { text: "F) بدون دارو نمی‌رم بیرون", score: -20, cause: ["مصرف ترکیبی", "فروپاشی روانی", "اور دوز"] }
                    ]
                },
                {
                    text: "20. چند بار از زندگی جنسی‌ت تهی شدی؟",
                    options: [
                        { text: "A) هیچ‌وقت", score: 5, cause: ["کهولت سن و عوامل طبیعی"] },
                        { text: "B) گهگاه", score: -3, cause: ["افسردگی"] },
                        { text: "C) همیشه یه چیزی کم بود", score: -7, cause: ["افسردگی", "پرخاشگری"] },
                        { text: "D) فقط جسمی بود", score: -12, cause: ["افسردگی", "پرخاشگری"] },
                        { text: "E) کثیف و بی‌احساس", score: -18, cause: ["افسردگی", "پرخاشگری", "خودکشی"] },
                        { text: "F) حس تجاوز به خودم داشتم", score: -25, cause: ["افسردگی عمیق", "پرخاشگری", "خودکشی", "اختلال روانی"] }
                    ]
                },
                {
                    text: "21. چقدر از برنامه‌های مالی برای آینده‌ت داری؟",
                    options: [
                        { text: "A) برنامه‌ریزی دقیق", score: 5, cause: ["کهولت سن و عوامل طبیعی"] },
                        { text: "B) پس‌انداز دارم", score: 2, cause: ["کهولت سن و عوامل طبیعی"] },
                        { text: "C) ندارم ولی می‌خوام داشته باشم", score: 0, cause: ["استرس مالی"] },
                        { text: "D) درآمد دارم، ولی همه‌ش خرج می‌شه", score: -3, cause: ["استرس مالی", "سکته"] },
                        { text: "E) دستم خالیه و بدهکارم", score: -8, cause: ["استرس مالی", "خودکشی"] },
                        { text: "F) اصلاً به آینده فکر نمی‌کنم", score: -12, cause: ["استرس مالی", "خودکشی", "فروپاشی روانی"] }
                    ]
                },
                {
                    text: "22. شغل‌ت چقدر استرس داره؟",
                    options: [
                        { text: "A) آروم و بدون استرس", score: 5, cause: ["کهولت سن و عوامل طبیعی"] },
                        { text: "B) گاهی استرس داره", score: 0, cause: ["فشار خون"] },
                        { text: "C) استرسش زیاده", score: -5, cause: ["سکته مغزی", "فشار خون"] },
                        { text: "D) شغلم پر از فشارهای روانیه", score: -10, cause: ["سکته مغزی", "فشار خون", "فروپاشی عصبی"] },
                        { text: "E) از کارم متنفرم", score: -15, cause: ["سکته مغزی", "فشار خون", "افسردگی"] },
                        { text: "F) شغل؟ ندارم که استرسش رو بکشم", score: -2, cause: ["افسردگی", "فقر"] }
                    ]
                },
                {
                    text: "23. چند بار در ماه فست‌فود یا غذای چرب می‌خوری؟",
                    options: [
                        { text: "A) صفر", score: 5, cause: ["کهولت سن و عوامل طبیعی"] },
                        { text: "B) یکی دو بار", score: 2, cause: ["کلسترول"] },
                        { text: "C) هفته‌ای یکی دو بار", score: -5, cause: ["کلسترول", "فشار خون", "چاقی"] },
                        { text: "D) اغلب اوقات", score: -10, cause: ["دیابت", "چاقی", "قلب"] },
                        { text: "E) بیشتر وعده‌هام فست‌فوده", score: -15, cause: ["دیابت", "چاقی", "قلب", "سوءتغذیه"] },
                        { text: "F) من با این چیزا زنده‌ام", score: -20, cause: ["دیابت", "چاقی مرگبار", "سکته قلبی"] }
                    ]
                },
                {
                    text: "24. از محیط اطراف‌ت راضی‌ای؟",
                    options: [
                        { text: "A) کاملاً", score: 5, cause: ["کهولت سن و عوامل طبیعی"] },
                        { text: "B) نسبتاً", score: 0, cause: ["افسردگی"] },
                        { text: "C) گاهی اذیتم", score: -3, cause: ["افسردگی", "تنش روانی"] },
                        { text: "D) حس می‌کنم هیچ‌جا امنیت ندارم", score: -8, cause: ["قتل", "تنش روانی", "اختلال روانی"] },
                        { text: "E) شهر منو خفه کرده", score: -12, cause: ["قتل", "افسردگی", "تنش روانی"] },
                        { text: "F) از همه آدما متنفرم", score: -18, cause: ["قتل", "درگیری", "انفجار عصبی"] }
                    ]
                },
                {
                    text: "25. آخرین بار که آزمایش خون دادی؟",
                    options: [
                        { text: "A) کمتر از ۶ ماه", score: 5, cause: ["کهولت سن و عوامل طبیعی"] },
                        { text: "B) امسال", score: 3, cause: ["کهولت سن و عوامل طبیعی"] },
                        { text: "C) سال گذشته", score: -2, cause: ["تشخیص دیررس بیماری‌ها"] },
                        { text: "D) چند سال پیش", score: -7, cause: ["تشخیص دیررس بیماری‌ها", "مرگ ناگهانی"] },
                        { text: "E) یادم نیست", score: -12, cause: ["تشخیص دیررس بیماری‌ها", "مرگ ناگهانی"] },
                        { text: "F) از دکتر می‌ترسم", score: -18, cause: ["تشخیص دیررس بیماری‌ها", "مرگ ناگهانی"] }
                    ]
                },
                {
                    text: "26. چقدر به حرف آدما اهمیت می‌دی؟",
                    options: [
                        { text: "A) هیچ‌چقدر", score: 5, cause: ["کهولت سن و عوامل طبیعی"] },
                        { text: "B) کم", score: 2, cause: ["تنش روانی"] },
                        { text: "C) زیاد", score: -5, cause: ["افسردگی", "تنش روانی"] },
                        { text: "D) حرف آدما منو می‌کُشه", score: -10, cause: ["افسردگی", "خودکشی"] },
                        { text: "E) حرفشون رو می‌زنم تو سرشون", score: -8, cause: ["قتل", "درگیری"] },
                        { text: "F) اونا خدای منن", score: -15, cause: ["افسردگی", "خودکشی", "فروپاشی روانی"] }
                    ]
                },
                {
                    text: "27. چند بار به مرگ نزدیک شدی؟",
                    options: [
                        { text: "A) هیچ‌وقت", score: 5, cause: ["کهولت سن و عوامل طبیعی"] },
                        { text: "B) یک بار", score: 0, cause: ["حادثه ناگهانی"] },
                        { text: "C) چندین بار", score: -5, cause: ["حادثه ناگهانی", "تصادف"] },
                        { text: "D) هر روز، انگار منتظرم", score: -15, cause: ["خودکشی", "تصادف", "حادثه"] },
                        { text: "E) از مرگ نمی‌ترسم", score: -10, cause: ["خودکشی", "تصادف"] },
                        { text: "F) مرگ رفیقمه", score: -20, cause: ["خودکشی", "تصادف", "حادثه"] }
                    ]
                },
                {
                    text: "28. سیگار یا قلیون می‌کشی؟",
                    options: [
                        { text: "A) هیچ‌وقت", score: 10, cause: ["کهولت سن و عوامل طبیعی"] },
                        { text: "B) تفریحی", score: 3, cause: ["بیماری‌های تنفسی"] },
                        { text: "C) ماهی یکی‌دو بار", score: -5, cause: ["بیماری‌های تنفسی", "سرطان"] },
                        { text: "D) روزانه", score: -10, cause: ["سرطان ریه", "بیماری‌های قلبی"] },
                        { text: "E) بدون سیگار نمی‌تونم", score: -15, cause: ["سرطان ریه", "بیماری‌های قلبی", "سکته"] },
                        { text: "F) سیگار و قلیون غذای منه", score: -20, cause: ["سرطان ریه", "بیماری‌های قلبی", "سکته"] }
                    ]
                },
                {
                    text: "29. وضعیت روانی‌ت چطوره؟",
                    options: [
                        { text: "A) عالی و پایدار", score: 5, cause: ["کهولت سن و عوامل طبیعی"] },
                        { text: "B) معمولی", score: 2, cause: ["افسردگی"] },
                        { text: "C) نوسان زیاد دارم", score: -5, cause: ["اختلال روانی", "خودکشی"] },
                        { text: "D) از نظر بقیه دیوونه‌م", score: -10, cause: ["اختلال روانی", "خودکشی", "قتل"] },
                        { text: "E) احساس می‌کنم کنترلی روی خودم ندارم", score: -15, cause: ["اختلال روانی", "قتل", "خودزنی"] },
                        { text: "F) روانی‌م، ولی کی جرئت داره بگه؟", score: -20, cause: ["اختلال روانی", "قتل", "خودکشی"] }
                    ]
                },
                {
                    text: "30. به چه میزان به سلامتی‌ت اهمیت می‌دی؟",
                    options: [
                        { text: "A) خیلی زیاد، مرتب پیگیری می‌کنم", score: 10, cause: ["کهولت سن و عوامل طبیعی"] },
                        { text: "B) در حد نرمال", score: 5, cause: ["کهولت سن و عوامل طبیعی"] },
                        { text: "C) کم", score: -5, cause: ["تشخیص دیررس بیماری‌ها"] },
                        { text: "D) فقط وقتی مریض میشم", score: -10, cause: ["تشخیص دیررس بیماری‌ها", "مرگ ناگهانی"] },
                        { text: "E) بی‌خیالم", score: -15, cause: ["تشخیص دیررس بیماری‌ها", "مرگ ناگهانی", "سکته"] },
                        { text: "F) سلامتی؟ مهم نیست، مهم اینه که بمیرم", score: -20, cause: ["خودکشی", "مرگ ناگهانی"] }
                    ]
                }
            ];

            const poems = [
                "اینجا کسی خفته که عمری به یاد داشت،\nخیر و نیکی را به قلب و جان کاشت.",
                "سایهٔ وجودش گرمی‌بخش بود،\نروحش اکنون در بهشت جاودانه خفت.",
                "عشق او چون شعله‌ای در دل‌هاست،\nگرچه رفته، یاد او همیشه با ماست.",
                "خاک سرد، آرامگاه جسم او،\nروح او، آزاد از این دنیای پوچ.",
                "او رفت و یادش به دل‌ها ماندگار،\nدر این سرای فانی، بود او یک یادگار.",
                "در این سکوت ابدی، خوابیده است،\nآنکه از دنیا و غمش بریده است.",
                "اینجا پایان یک زندگی نیست،\nآغاز سفری نو، تا ابدیت است.",
                "عشق او مانند خورشید تابید،\nدر تاریکی دل‌ها، نوری دمید.",
                "آنکه رفت، از دنیا تنها شد،\nدر کنار خدا، آسوده خفت.",
                "قلب او دریایی از محبت بود،\nیادش همیشه در دل‌ها جاویدان است.",
                "گرچه دیگر نیست، در یادها زنده است،\nآنکه عشق و خوبی را به ما آموخت.",
                "زیر این خاک، جسمی آرام خفته،\nروانش به سوی آسمان‌ها رفته.",
                "اینجا خفته آنکه دلش پاک بود،\nهمچو قطره‌ای در دریای نور بود.",
                "او رفت و دل‌ها به سوگش نشستند،\nاما خاطراتش، هرگز از یاد نرفتند.",
                "سخن عشق او را همه شنیدند،\nاز این دنیا به دنیایی دیگر پریدند.",
                "چو پرنده‌ای از قفس رها شد،\nبه سوی باغ ابدی پرواز کرد.",
                "آنکه در دل ما جای گرفت،\nتا ابد، نامش در یادها ماندگار است.",
                "خواب شیرین ابدی، در این مکان،\nتا روز حشر، در آرامش و امان.",
                "ای دوست، اگر گذرت بر این قبر افتاد،\nدعایی به روح خفته در خاک یاد کن.",
                "ما همه از خداییم و به سوی او بازمی‌گردیم،\nاینجا پایان راهی نیست، آغاز است."
            ];

            const bios = [
                "او فردی بود که با سخت‌کوشی و پشتکار، همیشه به دنبال اهدافش می‌رفت. در تمام مراحل زندگی، امیدش را از دست نداد و به دیگران هم انگیزه می‌داد.",
                "زندگی او پر از ماجراجویی و هیجان بود. همیشه به دنبال تجربه‌های جدید بود و هیچ وقت از ریسک کردن نمی‌ترسید.",
                "او فردی آرام و متفکر بود. بیشتر وقتش را به مطالعه و یادگیری می‌گذراند و همیشه در پی کشف حقایق بود.",
                "او همیشه به دیگران کمک می‌کرد و هرگز از سختی‌ها خسته نمی‌شد. لبخندش، نشانه‌ای از امید و مهربانی بود.",
                "در زندگی‌اش، عشق به خانواده حرف اول را می‌زد. همه لحظاتش را با عزیزانش سپری کرد و خاطرات شیرینی به یادگار گذاشت.",
                "او یک هنرمند به تمام معنا بود. هر چیزی که به دستش می‌رسید، به یک اثر هنری زیبا تبدیل می‌کرد.",
                "روحیه ورزشی و رقابتی‌اش مثال‌زدنی بود. همیشه برای رسیدن به بهترین‌ها تلاش می‌کرد و هیچ وقت ناامید نمی‌شد.",
                "او همیشه به دنبال حقیقت بود و از دروغ و ریا دوری می‌کرد. یک زندگی صادقانه و پر از آرامش را برای خودش ساخت.",
                "زندگی او سرشار از سفر و کشف بود. هر جا که می‌رفت، بخشی از قلبش را همانجا جا می‌گذاشت و به یادگار می‌گرفت.",
                "او یک فعال اجتماعی بود و همیشه برای بهبود جامعه تلاش می‌کرد. هرگز از مبارزه برای حقوق دیگران دست نکشید.",
                "همیشه لبخندی بر لب داشت و به همه انرژی مثبت می‌داد. حضورش در هر جمعی، باعث شادی و نشاط بود.",
                "زندگی‌اش مثل یک کتاب پرماجرا بود. هر صفحه از آن، یک درس جدید و یک تجربه تازه داشت.",
                "او یک معلم به دنیا آمده بود. دانش و تجربه‌اش را با همه به اشتراک می‌گذاشت و به دیگران کمک می‌کرد تا رشد کنند.",
                "او یک فرد خلاق و نوآور بود. همیشه ایده‌های جدیدی داشت و هیچ وقت از امتحان کردن آن‌ها نمی‌ترسید.",
                "زندگی او سرشار از موسیقی و هنر بود. هر لحظه از زندگی‌اش، با یک نوای زیبا همراه بود.",
                "او یک فرد باهوش و بااستعداد بود. هیچ چالشی برایش سخت نبود و همیشه راهی برای حل مشکلات پیدا می‌کرد.",
                "زندگی او مثل یک شعر زیبا بود. هر کلمه‌اش، پر از احساس و معنی بود.",
                "او یک فرد صبور و آرام بود. هیچ چیز نمی‌توانست او را از مسیرش منحرف کند و همیشه با آرامش به همه چیز نگاه می‌کرد.",
                "زندگی او سرشار از خنده و شادی بود. هیچ وقت از شوخی و تفریح خسته نمی‌شد و همیشه به دنبال شادی بود.",
                "او یک فرد مهربان و دلسوز بود. همیشه به فکر دیگران بود و هرگز از کمک به آن‌ها دریغ نمی‌کرد.",
                "زندگی او مثل یک نقاشی زیبا بود. هر رنگ، نشانه‌ای از احساس و عشقش بود.",
                "او یک فرد شجاع و جسور بود. هیچ ترسی از شکست نداشت و همیشه با شجاعت به سمت اهدافش می‌رفت.",
                "زندگی او سرشار از عشق و محبت بود. هر کجا که قدم می‌گذاشت، بذر عشق و محبت را می‌کاشت.",
                "او یک فرد با ایمان و اعتقاد بود. همیشه به خدا توکل می‌کرد و هیچ وقت ناامید نمی‌شد.",
                "زندگی او مثل یک رودخانه بود. همیشه در حال حرکت و جریان بود و هیچ وقت متوقف نمی‌شد.",
                "او یک فرد متواضع و فروتن بود. هرگز به خود مغرور نمی‌شد و همیشه با احترام با دیگران رفتار می‌کرد.",
                "او فردی با حس مسئولیت بالا بود. همیشه به عهد خود پایبند بود و به دیگران اعتماد می‌کرد.",
                "زندگی‌اش سرشار از لحظات خوش و شیرین بود. او همیشه به دنبال ساختن خاطرات خوب با عزیزانش بود.",
                "او یک فرد منظم و دقیق بود. هر کاری را با دقت و وسواس انجام می‌داد و به جزئیات اهمیت می‌داد.",
                "زندگی‌اش مثل یک تابلوی نقاشی بود که خودش آن را با عشق و علاقه رنگ کرده بود."
            ];

            const suggestions = [
                "زنگ بزن به هر کسی که اذیتت کرده و هرچی دلت می‌خواد بهش بگو. چون دیگه بعدش فرصتی نیست.",
                "به اون دوستت که پولش رو خورده بودی زنگ بزن، بگو شرمنده داداش. اون دنیا جبران می‌کنم.",
                "سنگ قبر خودت رو از همین الان بخر و بگو چی دوست داری روش حکاکی شه. سلیقه‌ت رو به نسل‌های بعد نشون بده.",
                "تمام بدهی‌هات رو صاف کن تا بعد از تو، اطرافیانت با مشکلات مالی روبرو نشن.",
                "تمام رمزهای عبور شبکه‌های اجتماعیت رو یادداشت کن و بذار توی کشوی میزت تا بعد از تو، همه بتونن از خاطراتت لذت ببرن.",
                "اون لباسی که همیشه دوست داشتی بخری و به خودت می‌گفتی «حیفه»، همین امروز بخر و بپوش.",
                "به کسی که دوستش داری زنگ بزن و بگو «دوستت دارم»، چون شاید دیگه فرصتی نباشه.",
                "یک سلفی با تمام کسانی که دوستشون داری بگیر و بذار توی قاب تا به یادگار بمونه.",
                "اگر از کسی کینه‌ای به دل داری، ببخش تا خودت سبک‌بارتر بشی.",
                "اگر به کسی قول دادی و عمل نکردی، همین امروز جبران کن.",
                "اگر از کسی ناراحت هستی، بهش بگو و باهاش صحبت کن.",
                "یک وعده غذای سالم و خوشمزه برای خودت درست کن و با لذت بخورش.",
                "یک فیلمی رو ببین که همیشه دوست داشتی و فرصت تماشاش رو نداشتی.",
                "یک شعر از حافظ یا سعدی انتخاب کن و برای خودت بخون.",
                "یک کار خیر انجام بده و به کسی که نیاز داره کمک کن.",
                "اگر از کسی پول قرض گرفتی، همین امروز پس بده.",
                "یک کار هنری یا دستی انجام بده و به خودت افتخار کن.",
                "یک نامه به پدر و مادرت بنویس و ازشون تشکر کن.",
                "یک لیست از کارهایی که همیشه دوست داشتی انجام بدی اما هیچ وقت وقتش رو نداشتی، آماده کن و هر طور شده همون امروز انجامشون بده.",
                "یک مسافرت طولانی برو و هر جایی که دوست داری برو و با دنیا خداحافظی کن.",
                "برو به اون رستورانی که همیشه دوست داشتی بری و گرون بود، و هر چی دلت می‌خواد سفارش بده.",
                "تمام کتاب‌هایی رو که همیشه می‌خواستی بخونی و فرصت نداشتی، شروع کن.",
                "به یه دوستت که مدام غر می‌زنه، زنگ بزن و بهش بگو «غر نزن، زندگی کوتاهه».",
                "تمام عکس‌های قدیمی رو مرور کن و با یادآوری خاطرات، لبخند بزن.",
                "یک درخت بکار. حتی اگر قرار نیست درختی رو که کاشتی ببینی، مطمئن باش سایه‌اش به سر یکی از عزیزانت می‌رسه.",
                "تمامی وسایلی که به دردت نمی‌خوره رو ببخش به نیازمندان تا علاوه بر کمک به دیگران، اطرافیان بعد از تو برای جمع کردنشون به مشکل نخورن.",
                "تمام حساب‌وکتاب‌های مالی‌ات رو شفاف کن تا ورثه بعد از تو گیج نشن.",
                "اگر از کسی ناراحت هستی و نمی‌خوای باهاش صحبت کنی، حداقل یه نامه براش بنویس و بعد پاره کن تا سبک شی.",
                "یه لیست از آدمایی که دوستشون داری بنویس و بهشون بگو چقدر برات مهمن.",
                "یاد بگیر که چطور یه غذای خوشمزه درست کنی تا حداقل یک خاطره خوب از آشپزی‌ات به جا بمونه."
            ];

            const showSection = (section) => {
                userInfoSection.style.display = 'none';
                questionsSection.style.display = 'none';
                resultsSection.style.display = 'none';
                section.style.display = 'block';
            };

            const generateQuestions = () => {
                questionsForm.innerHTML = '';
                questions.forEach((q, index) => {
                    const questionDiv = document.createElement('div');
                    questionDiv.classList.add('question');
                    questionDiv.innerHTML = `
                        <p>${q.text}</p>
                        <div class="options-container">
                            ${q.options.map((option, i) => `
                                <div class="option">
                                    <input type="radio" id="q${index}-o${i}" name="q${index}" value="${option.score}" data-cause='${JSON.stringify(option.cause)}' required>
                                    <label for="q${index}-o${i}">${option.text}</label>
                                </div>
                            `).join('')}
                        </div>
                    `;
                    questionsForm.appendChild(questionDiv);
                });
            };

            const calculateLifeExpectancy = (totalScore) => {
                let baseLife = 80;
                let deathAge = baseLife + (totalScore / 10);
                return Math.max(40, Math.min(120, Math.floor(deathAge)));
            };

            const getRandomElement = (array) => {
                return array[Math.floor(Math.random() * array.length)];
            };

            const getDeathDetails = (deathAge) => {
                const today = new Date();
                const birthYear = today.getFullYear() - userAge;
                const deathDate = new Date();
                deathDate.setFullYear(birthYear + deathAge);
                deathDate.setMonth(Math.floor(Math.random() * 12));
                deathDate.setDate(Math.floor(Math.random() * 28) + 1);
                deathDate.setHours(Math.floor(Math.random() * 24));
                deathDate.setMinutes(Math.floor(Math.random() * 60));

                const deathJalali = new Intl.DateTimeFormat('fa-IR', {
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric',
                    hour: 'numeric',
                    minute: 'numeric'
                }).format(deathDate);

                const weekday = new Intl.DateTimeFormat('fa-IR', { weekday: 'long' }).format(deathDate);

                return {
                    birthYear,
                    deathJalali: `${deathJalali} (${weekday})`,
                };
            };

            const getCauseAndBio = (selectedCauses) => {
                const causeCounts = selectedCauses.reduce((acc, cause) => {
                    acc[cause] = (acc[cause] || 0) + 1;
                    return acc;
                }, {});
                
                const sortedCauses = Object.keys(causeCounts).sort((a, b) => causeCounts[b] - causeCounts[a]);
                
                let deathCauseText = "علت فوت: علت دقیق فوت مشخص نیست، اما به احتمال زیاد به دلیل کهولت سن و عوامل طبیعی بوده است.";
                if (sortedCauses.length > 0) {
                    const primaryCause = sortedCauses[0];
                    if (sortedCauses.length > 1) {
                        const secondaryCause = sortedCauses[1];
                        deathCauseText = `علت فوت: به دلیل ${primaryCause} و در نهایت ${secondaryCause}.`;
                    } else {
                        deathCauseText = `علت فوت: ${primaryCause}.`;
                    }
                }

                const randomBio = getRandomElement(bios);
                return { deathCauseText, randomBio };
            };

            const showSuggestions = () => {
                suggestionsList.innerHTML = '';
                const shuffledSuggestions = suggestions.sort(() => 0.5 - Math.random());
                const selectedSuggestions = shuffledSuggestions.slice(0, Math.min(shuffledSuggestions.length, 5));
                selectedSuggestions.forEach(s => {
                    const li = document.createElement('li');
                    li.textContent = s;
                    suggestionsList.appendChild(li);
                });
            };

            userInfoForm.addEventListener('submit', (e) => {
                e.preventDefault();
                userName = nameInput.value;
                userAge = parseInt(ageInput.value, 10);
                
                if (userAge <= 0 || userAge > 120) {
                    alert('لطفا سن معتبر وارد کنید.');
                    return;
                }

                generateQuestions();
                showSection(questionsSection);
            });

            calculateBtn.addEventListener('click', () => {
                const formData = new FormData(questionsForm);
                let totalScore = 0;
                let selectedCauses = [];
                let answeredCount = 0;

                questions.forEach((q, index) => {
                    const selectedOption = questionsForm.querySelector(`input[name="q${index}"]:checked`);
                    if (selectedOption) {
                        totalScore += parseInt(selectedOption.value, 10);
                        answeredCount++;
                        const causes = JSON.parse(selectedOption.dataset.cause);
                        selectedCauses.push(...causes);
                    }
                });

                if (answeredCount < questions.length) {
                    alert('لطفا به تمام سوالات پاسخ دهید.');
                    return;
                }

                const deathAge = calculateLifeExpectancy(totalScore);
                const { birthYear, deathJalali } = getDeathDetails(deathAge);
                const { deathCauseText, randomBio } = getCauseAndBio(selectedCauses);
                const randomPoem = getRandomElement(poems);

                finalCongrats.textContent = `تبریک! تاریخ دقیق مرگ شما مشخص شد.`;
                tombstoneName.textContent = userName;
                tombstoneDates.textContent = `تاریخ تولد: ${birthYear} - وفات: ${deathJalali}`;
                tombstoneBio.textContent = randomBio;
                tombstoneCause.textContent = `${deathCauseText} (حدوداً در ${deathAge} سالگی)`;
                tombstonePoem.textContent = randomPoem;
                
                showSuggestions();
                showSection(resultsSection);
            });

            restartBtn.addEventListener('click', () => {
                userInfoForm.reset();
                questionsForm.innerHTML = '';
                showSection(userInfoSection);
            });
        });
    </script>
</body>
</html>
